---

- include: dialin_standalone.yml
  when: bbb_sipgw is not tdefined

- include: dialin_sipgw.yml
  when: bbb_sipgw is defined

- name: set bbb dialin number
  become: true
  lineinfile:
    path: /usr/share/bbb-web/WEB-INF/classes/bigbluebutton.properties
    regexp: '^defaultDialAccessNumber='
    line: 'defaultDialAccessNumber={{ bbb_sip_pretty_number }}'
  notify: reload bbb-web

- name: show dialin number in welcome message
  become: true
  lineinfile:
    path: /usr/share/bbb-web/WEB-INF/classes/bigbluebutton.properties
    regexp: '^defaultWelcomeMessageFooter='
    line: 'defaultWelcomeMessageFooter=<br>To join this meeting by phone, dial:<br>  %%DIALNUM%%<br>Then enter %%CONFNUM%% as the conference PIN number.'
  notify: reload bbb-web
